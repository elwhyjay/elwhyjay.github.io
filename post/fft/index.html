<!DOCTYPE html>

<script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><style>
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 8px;
      font-size: 1.2rem;
      cursor: pointer;
      background: none;
      border: 0px solid ;
      border-color: none;
      border-radius: 60%;
      z-index: 1000;
    }
    body[a="dark"] .theme-toggle {
        border-color: white;
    }
    body[a="dark"] #dark-icon {
        stroke: white;  
    }
</style>

<html lang="ko-kr"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="google-site-verification" content="CGHN0W7w6iWZ8ggs2E8eQ_Wiq1IuSxJHXr-KLZIetgk" />
   <meta name="description" content="Introduction
ì´ í¬ìŠ¤íŠ¸ì—ì„œ ë‹¤ë£°ê²ƒì€ Fast fourier Transformì´ë‹¤. ì´ ì•Œê³ ë¦¬ì¦˜ì—ëŒ€í•´ì„œëŠ” PS(Competitve programming) í•˜ëŠ” ì‚¬ëŒë“¤ì€ ìµíˆ ì•Œê²ƒì´ë‹¤. ì‹¤ì œë¡œ ê²€ìƒ‰ì„í•´ë³´ë©´ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ì„œëŠ” ìƒì„¸íˆ ì•Œìˆ˜ê°€ìˆë‹¤. ê·¸ë ‡ê¸°ë•Œë¬¸ì— ì•Œê³ ë¦¬ì¦˜ì„ í†ºì•„ë³´ê¸°ë³´ë‹¤ GPUìœ„ì—ì„œ FFTë¥¼ êµ¬í˜„í•˜ëŠ”ê²ƒì—ëŒ€í•´ ì´ˆì ì„ ë§ì¶° ê¸€ì„ ì‘ì„±í•  ì˜ˆì •ì´ë‹¤.
Background
Fourier Transform
Fourier Transform(í‘¸ë¦¬ì— ë³€í™˜)ì€ ì‹ í˜¸ë¥¼ ì£¼íŒŒìˆ˜ ì„±ë¶„ìœ¼ë¡œ ë¶„í•´í•˜ëŠ” ìˆ˜í•™ì  ê¸°ë²•ì´ë‹¤. ì´ëŠ” ì‹œê°„ ë„ë©”ì¸ì—ì„œ í‘œí˜„ëœ ì‹ í˜¸ë¥¼ ì£¼íŒŒìˆ˜ ë„ë©”ì¸ìœ¼ë¡œ ë³€í™˜í•˜ì—¬, ì‹ í˜¸ì˜ ì£¼íŒŒìˆ˜ íŠ¹ì„±ì„ ë¶„ì„í•˜ê³  ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. í‘¸ë¦¬ì— ë³€í™˜ì€ ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ í™œìš©ë˜ë©°, íŠ¹íˆ ì‹ í˜¸ ì²˜ë¦¬, ì´ë¯¸ì§€ ì²˜ë¦¬, ìŒì„± ì¸ì‹, í†µì‹  ì‹œìŠ¤í…œ ë“±ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ í•œë‹¤. ì •ì˜ëŠ” ì´ëŸ¬í•œë° ê·¸ë ‡ë‹¤ë©´ í‘¸ë¦¬ì— ë³€í™˜ì€ ì´ëŸ° íŠ¹ì • ë„ë©”ì¸ì´ ì•„ë‹ˆë©´ ì „í˜€ ì“¸ëª¨ê°€ ì—†ëŠ”ê²ƒì¼ê¹Œ? ìµíˆ ì•Œë ¤ì ¸ìˆë“¯ ì´ëŸ¬í•œ ë„ë©”ì¸ì´ì•„ë‹ˆë¼ ì¼ë°˜ì ì¸ ì—°ì‚° ì˜ì—­ì—ì„œë„ í‘¸ë¦¬ì— ë³€í™˜ì€ ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤. ì´ë¥¼ ì¤‘ì ìœ¼ë¡œ ì‚´í´ë³´ì.">  
  
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-YXXYQPDYLX"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-YXXYQPDYLX');
        }
      </script>

  <title>
    
      FFT on GPU
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
  
  
  
  <link rel="stylesheet" href="/css/main.52bb1e9d4377eb8c8882cfcd334b1f0806eefe0c6e0074ecfdeb36f05cee36fcbc305e7421bb436a666cf7f14d41d3775bcda923f9dd5c661d39a44533c0e7bc.css" integrity="sha512-UrsenUN364yIgs/NM0sfCAbu/gxuAHTs/es28FzuNvy8MF50IbtDamZs9/FNQdN3W82pI/ndXGYdOaRFM8DnvA==" />
   <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 
</head>
<style>
        table {
            border-collapse: collapse;
            border: 1px solid #ebebeb;
        }
        
        th, td {
            border: 1px solid #ffffff;
            padding: 8px;
        }
        th {
            background-color: #2290e5;
        }
        
    </style>
    
    <body a="auto">
        <button class="theme-toggle" onclick="toggleTheme()">
            <span class="light-icon">
                <svg id="light-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
            </span>
            <span class="dark-icon" style="display:none">
                <svg id="dark-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </span>
            
            
        </button>
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">..</a>


<article>
    <p class="post-meta">
        <time datetime="2026-02-07 00:35:33 &#43;0900 KST">
            2026-02-07
        </time>
    </p>

    <h1>FFT on GPU</h1>

    

    <h1 id="introduction">Introduction</h1>
<p>ì´ í¬ìŠ¤íŠ¸ì—ì„œ ë‹¤ë£°ê²ƒì€ Fast fourier Transformì´ë‹¤. ì´ ì•Œê³ ë¦¬ì¦˜ì—ëŒ€í•´ì„œëŠ” PS(Competitve programming) í•˜ëŠ” ì‚¬ëŒë“¤ì€ ìµíˆ ì•Œê²ƒì´ë‹¤. ì‹¤ì œë¡œ ê²€ìƒ‰ì„í•´ë³´ë©´ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ì„œëŠ” ìƒì„¸íˆ ì•Œìˆ˜ê°€ìˆë‹¤. ê·¸ë ‡ê¸°ë•Œë¬¸ì— ì•Œê³ ë¦¬ì¦˜ì„ í†ºì•„ë³´ê¸°ë³´ë‹¤ GPUìœ„ì—ì„œ FFTë¥¼ êµ¬í˜„í•˜ëŠ”ê²ƒì—ëŒ€í•´ ì´ˆì ì„ ë§ì¶° ê¸€ì„ ì‘ì„±í•  ì˜ˆì •ì´ë‹¤.</p>
<h1 id="background">Background</h1>
<h2 id="fourier-transform">Fourier Transform</h2>
<p>Fourier Transform(í‘¸ë¦¬ì— ë³€í™˜)ì€ ì‹ í˜¸ë¥¼ ì£¼íŒŒìˆ˜ ì„±ë¶„ìœ¼ë¡œ ë¶„í•´í•˜ëŠ” ìˆ˜í•™ì  ê¸°ë²•ì´ë‹¤. ì´ëŠ” ì‹œê°„ ë„ë©”ì¸ì—ì„œ í‘œí˜„ëœ ì‹ í˜¸ë¥¼ ì£¼íŒŒìˆ˜ ë„ë©”ì¸ìœ¼ë¡œ ë³€í™˜í•˜ì—¬, ì‹ í˜¸ì˜ ì£¼íŒŒìˆ˜ íŠ¹ì„±ì„ ë¶„ì„í•˜ê³  ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. í‘¸ë¦¬ì— ë³€í™˜ì€ ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ í™œìš©ë˜ë©°, íŠ¹íˆ ì‹ í˜¸ ì²˜ë¦¬, ì´ë¯¸ì§€ ì²˜ë¦¬, ìŒì„± ì¸ì‹, í†µì‹  ì‹œìŠ¤í…œ ë“±ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ í•œë‹¤. ì •ì˜ëŠ” ì´ëŸ¬í•œë° ê·¸ë ‡ë‹¤ë©´ í‘¸ë¦¬ì— ë³€í™˜ì€ ì´ëŸ° íŠ¹ì • ë„ë©”ì¸ì´ ì•„ë‹ˆë©´ ì „í˜€ ì“¸ëª¨ê°€ ì—†ëŠ”ê²ƒì¼ê¹Œ? ìµíˆ ì•Œë ¤ì ¸ìˆë“¯ ì´ëŸ¬í•œ ë„ë©”ì¸ì´ì•„ë‹ˆë¼ ì¼ë°˜ì ì¸ ì—°ì‚° ì˜ì—­ì—ì„œë„ í‘¸ë¦¬ì— ë³€í™˜ì€ ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤. ì´ë¥¼ ì¤‘ì ìœ¼ë¡œ ì‚´í´ë³´ì.</p>
<p>ìš°ì„  í‘¸ë¦¬ì— ë³€í™˜ì˜ ë³µì¡í•œ ìˆ˜í•™ì  ì •ì˜ëŠ” ìƒëµí•˜ê³  í‘¸ë¦¬ì— ë³€í™˜ì´ ì£¼ìš” ì‚¬ìš©ë˜ëŠ” ì§€ì ë“¤ì„ ë³´ë©´ ì‹ í˜¸ì™€ ê°™ì´ ì£¼ê¸°ë¥¼ ê°€ì§€ê³  ìˆëŠ” ë°ì´í„°ì—ì„œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©ëœë‹¤. ì´ëŸ° ì£¼ê¸°ì„±ì´ ì¤‘ìš”í•¨ì„ ì¸ì§€í•˜ê³  ë„˜ì–´ê°€ì.</p>
<h2 id="discrete-fourier-transform">Discrete Fourier Transform</h2>
<p>ì‹¤ì œ ì»´í“¨í„°ì—ì„œ ë‹¤ë£¨ëŠ” ë°ì´í„°ëŠ” ì—°ì†ì ì¸ ì‹ í˜¸ê°€ ì•„ë‹ˆë¼ ì´ì‚°ì ì¸ ìƒ˜í”Œë¡œ í‘œí˜„ëœë‹¤. ë”°ë¼ì„œ í‘¸ë¦¬ì— ë³€í™˜ì„ ì»´í“¨í„°ì—ì„œ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ì´ì‚° í‘¸ë¦¬ì— ë³€í™˜(Discrete Fourier Transform, DFT)ì„ ì‚¬ìš©í•œë‹¤. DFTëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ëœë‹¤:
$$X_k = \sum_{n=0}^{N-1} x_n \cdot e^{-i \frac{2\pi}{N} kn}$$
ì—¬ê¸°ì„œ:</p>
<ul>
<li>$X_k$: ì£¼íŒŒìˆ˜ ë„ë©”ì¸ì—ì„œì˜ kë²ˆì§¸ ì„±ë¶„</li>
<li>$x_n$: ì‹œê°„ ë„ë©”ì¸ì—ì„œì˜ në²ˆì§¸ ìƒ˜í”Œ</li>
<li>$N$: ìƒ˜í”Œì˜ ì´ ê°œìˆ˜</li>
<li>$e^{-i \frac{2\pi}{N} kn}$: ë³µì†Œ ì§€ìˆ˜ í•¨ìˆ˜ë¡œ, ì£¼íŒŒìˆ˜ ë³€í™˜ì„ ìˆ˜í–‰í•˜ëŠ” ì—­í• </li>
</ul>
<p>ì´ë•Œ $e^{-i \frac{2\pi}{N} kn}$ëŠ” ì˜¤ì¼ëŸ¬ ê³µì‹ì— ì˜í•´ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„ë  ìˆ˜ ìˆë‹¤:
$$e^{-i \frac{2\pi}{N} kn} = \cos\left(\frac{2\pi}{N} kn\right) - i \sin\left(\frac{2\pi}{N} kn\right)$$</p>
<p>ì´ ìˆ˜ì‹ì—ì„œ ëª¨ë“  $k$ì— ëŒ€í•´ ëª¨ë“  $n$ì„ ìˆœíšŒí•˜ë¯€ë¡œ DFTì˜ ê³„ì‚° ë³µì¡ë„ëŠ” $O(N^2)$ì´ë‹¤. ìƒ˜í”Œ ìˆ˜ê°€ ì»¤ì§ˆìˆ˜ë¡ ê³„ì‚° ì‹œê°„ì´ ê¸‰ê²©íˆ ëŠ˜ì–´ë‚˜ëŠ”ë°, ì´ë¥¼ ì¤„ì´ë ¤ë©´ ìˆ˜ì‹ ë‚´ë¶€ì— ì¬í™œìš© ê°€ëŠ¥í•œ êµ¬ì¡°ê°€ ìˆì–´ì•¼ í•œë‹¤. $e^{-i\frac{2\pi}{N}kn}$ í•­ì„ ì¢€ ë” ìì„¸íˆ ë“¤ì—¬ë‹¤ë³´ì.</p>
<h3 id="primitive-root-of-unity">Primitive Root of Unity</h3>
<p>ë³µì†Œ í‰ë©´ì˜ ë‹¨ìœ„ì›($|z|=1$) ìœ„ì— $N$ê°œì˜ ì ì„ ë“±ê°„ê²©ìœ¼ë¡œ ì°ìœ¼ë©´, ì´ ì ë“¤ì€ ë°©ì •ì‹ $z^N = 1$ì˜ í•´ê°€ ëœë‹¤. ì´ í•´ë“¤ ì¤‘ í•œ ì¹¸ íšŒì „ì— í•´ë‹¹í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ì ì„ primitive N-th root of unityë¼ í•˜ë©° ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•œë‹¤:
$$\omega_N = e^{-i \frac{2\pi}{N}}$$</p>
<p>ë‚˜ë¨¸ì§€ ì ë“¤ì€ $\omega_N$ì„ ê±°ë“­ì œê³±í•˜ë©´ ì „ë¶€ ì–»ì„ìˆ˜ ìˆë‹¤: $\omega_N^0, \omega_N^1, \omega_N^2, \ldots, \omega_N^{N-1}$. ì´ í‘œê¸°ë¥¼ ì‚¬ìš©í•˜ë©´ DFTëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê°„ê²°í•˜ê²Œ ë‹¤ì‹œ ì“¸ìˆ˜ ìˆë‹¤:
$$X_k = \sum_{n=0}^{N-1} x_n \cdot \omega_N^{kn}$$</p>
<p>ì´ê²Œ ë‹¨ìˆœíˆ í‘œê¸°ë¥¼ ì¤„ì¸ê²ƒì— ë¶ˆê³¼í•˜ë‹¤ë©´ êµ³ì´ ë„ì…í•  ì´ìœ ê°€ ì—†ë‹¤. í•µì‹¬ì€ $\omega_N$ì´ ê°€ì§€ëŠ” ëŒ€ìˆ˜ì  ì„±ì§ˆì— ìˆë‹¤. FFTë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ì„¸ ê°€ì§€ ì„±ì§ˆì„ ì‚´í´ë³´ì:</p>
<ol>
<li><strong>ì£¼ê¸°ì„±</strong>: $\omega_N^N = 1$ â€” ì§€ìˆ˜ê°€ $N$ì„ ë„˜ìœ¼ë©´ ë‹¤ì‹œ ì²˜ìŒìœ¼ë¡œ ëŒì•„ì˜¨ë‹¤.</li>
<li><strong>ëŒ€ì¹­ì„±</strong>: $\omega_N^{N/2} = -1$ â€” ë‹¨ìœ„ì›ì—ì„œ ì •ë°˜ëŒ€ ì ì´ë¯€ë¡œ ë¶€í˜¸ê°€ ë’¤ì§‘íŒë‹¤. ë”°ë¼ì„œ $\omega_N^{k+N/2} = -\omega_N^k$ì´ë‹¤.</li>
<li><strong>ì¶•ì†Œ(Halving)</strong>: $\omega_N^{2k} = \omega_{N/2}^k$ â€” ì œê³±í•˜ë©´ $N$-th rootê°€ $N/2$-th rootë¡œ ë°”ë€Œì–´ ë¬¸ì œ í¬ê¸°ê°€ ì ˆë°˜ì´ ëœë‹¤.</li>
</ol>
<p>ì´ ì„¸ ì„±ì§ˆì´ ì™œ ì¤‘ìš”í•œì§€ëŠ” FFTì˜ ìœ ë„ ê³¼ì •ì—ì„œ ë°”ë¡œ ë“œëŸ¬ë‚œë‹¤.</p>
<h2 id="fast-fourier-transform">Fast Fourier Transform</h2>
<p>FFTëŠ” ìœ„ ì„±ì§ˆë“¤ì„ í™œìš©í•˜ì—¬ DFTì˜ $O(N^2)$ë¥¼ $O(N \log N)$ìœ¼ë¡œ ì¤„ì´ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ê°€ì¥ ë„ë¦¬ ì•Œë ¤ì§„ Cooley-Tukey ì•Œê³ ë¦¬ì¦˜ì„ ë”°ë¼ê°€ë©° ìœ ë„í•´ë³´ì.</p>
<p>DFT ìˆ˜ì‹ì—ì„œ ì¸ë±ìŠ¤ $n$ì„ ì§ìˆ˜($2m$)ì™€ í™€ìˆ˜($2m+1$)ë¡œ ë‚˜ëˆ„ë©´:
$$X_k = \sum_{m=0}^{N/2-1} x_{2m} \cdot \omega_N^{2mk} + \sum_{m=0}^{N/2-1} x_{2m+1} \cdot \omega_N^{(2m+1)k}$$</p>
<p>ë‘ ë²ˆì§¸ í•­ì—ì„œ $\omega_N^k$ë¥¼ ë°–ìœ¼ë¡œ ë¹¼ë©´:
$$X_k = \sum_{m=0}^{N/2-1} x_{2m} \cdot \omega_N^{2mk} + \omega_N^k \sum_{m=0}^{N/2-1} x_{2m+1} \cdot \omega_N^{2mk}$$</p>
<p>ì—¬ê¸°ì„œ <strong>ì¶•ì†Œ ì„±ì§ˆ</strong> $\omega_N^{2mk} = \omega_{N/2}^{mk}$ë¥¼ ì ìš©í•˜ë©´:
$$X_k = \underbrace{\sum_{m=0}^{N/2-1} x_{2m} \cdot \omega_{N/2}^{mk}}_{E_k} + \omega_N^k \underbrace{\sum_{m=0}^{N/2-1} x_{2m+1} \cdot \omega_{N/2}^{mk}}_{O_k}$$</p>
<p>$E_k$ì™€ $O_k$ëŠ” ê°ê° í¬ê¸° $N/2$ì¸ DFTì´ë‹¤. ê·¸ë¦¬ê³  <strong>ëŒ€ì¹­ì„±</strong> $\omega_N^{k+N/2} = -\omega_N^k$ì— ì˜í•´:
$$X_{k+N/2} = E_k - \omega_N^k \cdot O_k$$</p>
<p>ì¦‰ $E_k$ì™€ $O_k$ë¥¼ í•œ ë²ˆ êµ¬í•˜ë©´ $X_k$ì™€ $X_{k+N/2}$ë¥¼ ë™ì‹œì— ì–»ì„ìˆ˜ ìˆë‹¤. ì´ê²ƒì´ butterfly ì—°ì‚°ì´ë‹¤. í¬ê¸° $N$ ë¬¸ì œê°€ í¬ê¸° $N/2$ ë¬¸ì œ 2ê°œ + $O(N)$ ê²°í•©ìœ¼ë¡œ ë¶„í• ë˜ë¯€ë¡œ:
$$T(N) = 2T(N/2) + O(N) = O(N \log N)$$</p>
<p>$\omega_N$ì˜ ì„±ì§ˆ ì„¸ ê°€ì§€ê°€ ì—†ì—ˆë‹¤ë©´ ì´ ë¶„í• ì€ ë¶ˆê°€ëŠ¥í–ˆì„ ê²ƒì´ë‹¤. ì´ì œ ì´ ì•Œê³ ë¦¬ì¦˜ì„ ë‹¤í•­ì‹ ê³±ì…ˆì— ì ìš©í•´ë³´ì.</p>
<h2 id="ë‹¤í•­ì‹-ê³±ì…ˆê³¼-fft">ë‹¤í•­ì‹ ê³±ì…ˆê³¼ FFT</h2>
<h3 id="ë‹¤í•­ì‹ì˜-ë‘-ê°€ì§€-í‘œí˜„">ë‹¤í•­ì‹ì˜ ë‘ ê°€ì§€ í‘œí˜„</h3>
<p>ë‹¤í•­ì‹ì„ í‘œí˜„í•˜ëŠ” ë°©ë²•ì—ëŠ” ë‘ ê°€ì§€ê°€ ìˆë‹¤.</p>
<p><strong>ê³„ìˆ˜ í‘œí˜„</strong>: ìš°ë¦¬ê°€ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” í˜•íƒœì´ë‹¤.
$$A(x) = a_0 + a_1 x + a_2 x^2 + \cdots + a_{n-1} x^{n-1}$$</p>
<p><strong>ì ê°’ í‘œí˜„</strong>: ì„œë¡œ ë‹¤ë¥¸ $N$ê°œì˜ ì ì—ì„œì˜ í•¨ìˆ˜ê°’ìœ¼ë¡œ ë‹¤í•­ì‹ì„ ë‚˜íƒ€ë‚´ëŠ” ë°©ë²•ì´ë‹¤.
$${(x_0, A(x_0)),\ (x_1, A(x_1)),\ \ldots,\ (x_{N-1}, A(x_{N-1}))}$$</p>
<p>$n-1$ì°¨ ë‹¤í•­ì‹ì€ $n$ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ ì ì—ì„œì˜ ê°’ìœ¼ë¡œ ìœ ì¼í•˜ê²Œ ê²°ì •ë˜ë¯€ë¡œ ë‘ í‘œí˜„ì€ ë™ì¹˜ì´ë‹¤.</p>
<p>ì ê°’ í‘œí˜„ì´ ê°•ë ¥í•œ ì´ìœ ëŠ” ê³±ì…ˆì— ìˆë‹¤. ë‘ ë‹¤í•­ì‹ $A(x)$, $B(x)$ì˜ ê³± $C(x) = A(x) \cdot B(x)$ë¥¼ ì ê°’ í‘œí˜„ì—ì„œ êµ¬í•˜ë©´, ê°™ì€ ì ì—ì„œì˜ ê°’ì„ ê·¸ëƒ¥ ê³±í•˜ê¸°ë§Œ í•˜ë©´ ëœë‹¤:
$$C(x_k) = A(x_k) \cdot B(x_k)$$</p>
<p>ì´ê²ƒì€ $O(N)$ì´ë‹¤. ë°˜ë©´ ê³„ìˆ˜ í‘œí˜„ì—ì„œì˜ ì§ì ‘ ê³±ì…ˆì€:
$$c_k = \sum_{i=0}^{k} a_i \cdot b_{k-i}$$</p>
<p>ì´ convolution ì—°ì‚°ì€ $O(n^2)$ì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ ì „ëµì€ ëª…í™•í•˜ë‹¤.</p>
<blockquote>
<p>ê³„ìˆ˜ í‘œí˜„ â†’ ì ê°’ í‘œí˜„ (ë³€í™˜) â†’ ì ë³„ ê³±ì…ˆ $O(N)$ â†’ ì ê°’ í‘œí˜„ â†’ ê³„ìˆ˜ í‘œí˜„ (ì—­ë³€í™˜)</p>
</blockquote>
<p>ì´ ì „ëµì´ ì˜ë¯¸ë¥¼ ê°€ì§€ë ¤ë©´ ë³€í™˜ê³¼ ì—­ë³€í™˜ì´ $O(n^2)$ë³´ë‹¤ ë¹¨ë¼ì•¼ í•œë‹¤.</p>
<h3 id="ì™œ-root-of-unityë¥¼-ëŒ€ì…ì ìœ¼ë¡œ-ê³ ë¥´ëŠ”ê°€">ì™œ Root of Unityë¥¼ ëŒ€ì…ì ìœ¼ë¡œ ê³ ë¥´ëŠ”ê°€</h3>
<p>ì„ì˜ì˜ $N$ê°œ ì ì— ë‹¤í•­ì‹ì„ ëŒ€ì…í•˜ë©´ ê° ì ë§ˆë‹¤ $O(N)$, ì ì´ $N$ê°œì´ë¯€ë¡œ ì´ $O(N^2)$ì´ë‹¤. ì•„ë¬´ ì ì´ë‚˜ ê³¨ë¼ì„œëŠ” ë‚˜ì•„ì§ˆê²Œ ì—†ë‹¤.</p>
<p>ì—¬ê¸°ì„œ í•µì‹¬ì ì¸ ê´€ì°°ì´ ë“±ì¥í•œë‹¤. ë‹¤í•­ì‹ $A(x)$ì— $\omega_N^k$ë¥¼ ëŒ€ì…í•˜ë©´:
$$A(\omega_N^k) = \sum_{j=0}^{n-1} a_j \cdot \omega_N^{jk}$$</p>
<p>ì´ê²ƒì€ ê³„ìˆ˜ $a_j$ì— ëŒ€í•œ DFTì™€ ì •í™•íˆ ê°™ì€ í˜•íƒœì´ë‹¤. ë‹¤ì‹œ ë§í•´ <strong>ë‹¤í•­ì‹ì„ roots of unityì—ì„œ í‰ê°€í•˜ëŠ” ê²ƒì´ ê³§ DFT</strong>ì´ë‹¤. ë‹¤í•­ì‹ ìì²´ì— ì£¼ê¸°ì„±ì´ ìˆì–´ì„œê°€ ì•„ë‹ˆë‹¤. ì£¼ê¸°ì  êµ¬ì¡°ë¥¼ ê°€ì§„ ì ë“¤ì„ ëŒ€ì…ì ìœ¼ë¡œ <strong>ì„ íƒ</strong>í•œ ê²ƒì´ê³ , ê·¸ ì ë“¤ì´ ê°€ì§„ ëŒ€ì¹­ì„±ê³¼ ì¶•ì†Œ ì„±ì§ˆ ë•ë¶„ì— ì•ì„œ ìœ ë„í•œ FFTë¥¼ ê·¸ëŒ€ë¡œ ì ìš©í•˜ì—¬ $O(N \log N)$ì— í‰ê°€í• ìˆ˜ ìˆëŠ”ê²ƒì´ë‹¤.</p>
<p>ì—­ë³€í™˜(ì ê°’ â†’ ê³„ìˆ˜) ì—­ì‹œ ê¹”ë”í•˜ë‹¤:
$$a_j = \frac{1}{N} \sum_{k=0}^{N-1} A(\omega_N^k) \cdot \omega_N^{-jk}$$</p>
<p>$\omega_N$ì„ $\omega_N^{-1}$ë¡œ ë°”ê¾¸ê³  $\frac{1}{N}$ì„ ê³±í•œê²ƒ ë¿ì´ë¯€ë¡œ, ì—­ë³€í™˜ë„ FFTì™€ ê°™ì€ êµ¬ì¡°ë¡œ $O(N \log N)$ì— ìˆ˜í–‰í• ìˆ˜ ìˆë‹¤. ë§Œì•½ ì„ì˜ì˜ ì ì„ ê³¨ëë‹¤ë©´ ì—­ë³€í™˜ì€ Vandermonde í–‰ë ¬ì˜ ì—­í–‰ë ¬ì„ êµ¬í•´ì•¼ í•˜ë¯€ë¡œ ì´ë ‡ê²Œ ê¹”ë”í•˜ê²Œ ë–¨ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤.</p>
<h3 id="ì „ì²´-ê³¼ì •">ì „ì²´ ê³¼ì •</h3>
<p>ì •ë¦¬í•˜ë©´ ë‘ ë‹¤í•­ì‹ $A(x)$, $B(x)$ì˜ ê³±ì…ˆì€ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰ëœë‹¤:</p>
<ol>
<li>$A(x)$ì™€ $B(x)$ì˜ ê³„ìˆ˜ ë²¡í„°ì— FFTë¥¼ ì ìš©í•˜ì—¬ ì ê°’ í‘œí˜„ìœ¼ë¡œ ë³€í™˜ â€” $O(N \log N)$</li>
<li>ë³€í™˜ëœ ì ê°’ì„ ìš”ì†Œë³„ë¡œ ê³±ì…ˆ â€” $O(N)$</li>
<li>ê²°ê³¼ì— ì—­ FFT(IFFT)ë¥¼ ì ìš©í•˜ì—¬ ê³„ìˆ˜ í‘œí˜„ìœ¼ë¡œ ë³µì› â€” $O(N \log N)$</li>
</ol>
<p>ê²°êµ­ ë‘ ë‹¤í•­ì‹ì˜ ê³±ì…ˆì„ $O(N \log N)$ì— ìˆ˜í–‰í• ìˆ˜ ìˆê²Œ ëœë‹¤. ì „ì²´ì ì¸ íë¦„ì„ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<p><img src="/img/FFT.png" alt="ë‹¤í•­ì‹ ê³±ì…ˆì„ ìœ„í•œ FFT ê³¼ì • ë‹¤ì´ì–´ê·¸ë¨"></p>
<h1 id="fft-on-gpu">FFT on GPU</h1>
<p>ìš°ì„  naiveí•œ  CUDA êµ¬í˜„ì²´ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cuda_runtime.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cmath&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>__global__ <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">copykernel</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">float</span><span style="color:#f92672">*</span> input, <span style="color:#66d9ef">float</span><span style="color:#f92672">*</span> output, <span style="color:#66d9ef">int</span> n) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> idx <span style="color:#f92672">=</span> blockDim.x <span style="color:#f92672">*</span> blockIdx.x <span style="color:#f92672">+</span> threadIdx.x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>n) {
</span></span><span style="display:flex;"><span>        output[idx] <span style="color:#f92672">=</span> input[idx];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>__global__ <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">bitReverseKernel</span>(<span style="color:#66d9ef">float</span> <span style="color:#f92672">*</span>input,<span style="color:#66d9ef">int</span> n, <span style="color:#66d9ef">int</span> lgn) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> idx <span style="color:#f92672">=</span> blockDim.x<span style="color:#f92672">*</span>blockIdx.x <span style="color:#f92672">+</span> threadIdx.x;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&lt;</span> n) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> rev <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> tmp <span style="color:#f92672">=</span> idx;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;i<span style="color:#f92672">&lt;</span>lgn;i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            rev <span style="color:#f92672">=</span> (rev<span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> (tmp <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>            tmp <span style="color:#f92672">&gt;&gt;=</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(idx<span style="color:#f92672">&lt;</span>rev){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> a0 <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>idx];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> a1 <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>idx<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> b0 <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>rev];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> b1 <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>rev<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>            input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>idx] <span style="color:#f92672">=</span> b0;
</span></span><span style="display:flex;"><span>            input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>idx<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> b1;
</span></span><span style="display:flex;"><span>            input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>rev] <span style="color:#f92672">=</span> a0;
</span></span><span style="display:flex;"><span>            input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>rev<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> a1;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>__global__ <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fft_kernel</span>(<span style="color:#66d9ef">float</span><span style="color:#f92672">*</span> input,<span style="color:#66d9ef">int</span> n,<span style="color:#66d9ef">int</span> depth) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> half <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> depth;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> stride <span style="color:#f92672">=</span> half <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> idx<span style="color:#f92672">=</span> blockDim.x <span style="color:#f92672">*</span> blockIdx.x <span style="color:#f92672">+</span> threadIdx.x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (idx <span style="color:#f92672">&lt;</span> n) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> pos <span style="color:#f92672">=</span> idx<span style="color:#f92672">%</span>stride;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (pos <span style="color:#f92672">&lt;</span> half) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> idx;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> half <span style="color:#f92672">+</span> i;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> xr <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>i];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> xi <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> yr <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>j];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> yi <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> angle <span style="color:#f92672">=</span> M_PI <span style="color:#f92672">*</span> pos <span style="color:#f92672">/</span> half;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> wr <span style="color:#f92672">=</span> <span style="color:#a6e22e">cosf</span>(angle);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> wi <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">sinf</span>(angle);
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> tr <span style="color:#f92672">=</span> wr <span style="color:#f92672">*</span> yr <span style="color:#f92672">-</span> wi <span style="color:#f92672">*</span> yi;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> ti <span style="color:#f92672">=</span> wi <span style="color:#f92672">*</span> yr <span style="color:#f92672">+</span> wr <span style="color:#f92672">*</span> yi;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>i] <span style="color:#f92672">=</span> xr <span style="color:#f92672">+</span> tr;
</span></span><span style="display:flex;"><span>            input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> xi <span style="color:#f92672">+</span> ti;
</span></span><span style="display:flex;"><span>            input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>j] <span style="color:#f92672">=</span> xr <span style="color:#f92672">-</span> tr;
</span></span><span style="display:flex;"><span>            input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> xi <span style="color:#f92672">-</span> ti;
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>__global__ <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">dft</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">float</span><span style="color:#f92672">*</span> input, <span style="color:#66d9ef">float</span><span style="color:#f92672">*</span> output ,<span style="color:#66d9ef">int</span> n) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> blockDim.x <span style="color:#f92672">*</span> blockIdx.x <span style="color:#f92672">+</span> threadIdx.x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (k <span style="color:#f92672">&lt;</span> n) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">float</span> sumRe <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0f</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">float</span> sumIm <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0f</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; t <span style="color:#f92672">&lt;</span> n; t<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> angle <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2.0f</span> <span style="color:#f92672">*</span> M_PI <span style="color:#f92672">*</span> k <span style="color:#f92672">*</span> t <span style="color:#f92672">/</span> n;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> wr <span style="color:#f92672">=</span> <span style="color:#a6e22e">cosf</span>(angle);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> wi <span style="color:#f92672">=</span> <span style="color:#a6e22e">sinf</span>(angle);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> xr <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>t];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">float</span> xi <span style="color:#f92672">=</span> input[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>t <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>            sumRe <span style="color:#f92672">+=</span> xr <span style="color:#f92672">*</span> wr <span style="color:#f92672">-</span> xi <span style="color:#f92672">*</span> wi;
</span></span><span style="display:flex;"><span>            sumIm <span style="color:#f92672">+=</span> xr <span style="color:#f92672">*</span> wi <span style="color:#f92672">+</span> xi <span style="color:#f92672">*</span> wr;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        output[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>k] <span style="color:#f92672">=</span> sumRe;
</span></span><span style="display:flex;"><span>        output[<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>k <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> sumIm;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">solve</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">float</span><span style="color:#f92672">*</span> signal, <span style="color:#66d9ef">float</span><span style="color:#f92672">*</span> spectrum, <span style="color:#66d9ef">int</span> N) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> lgn <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> tempN <span style="color:#f92672">=</span> N;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (tempN <span style="color:#f92672">&gt;&gt;=</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">++</span>lgn;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>((N <span style="color:#f92672">&amp;</span> (N <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> threadsPerBlock <span style="color:#f92672">=</span> <span style="color:#ae81ff">256</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> blocksPerGrid <span style="color:#f92672">=</span> (N <span style="color:#f92672">+</span> threadsPerBlock <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> threadsPerBlock;
</span></span><span style="display:flex;"><span>        dft<span style="color:#f92672">&lt;&lt;&lt;</span>blocksPerGrid, threadsPerBlock<span style="color:#f92672">&gt;&gt;&gt;</span>(signal,spectrum, N);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cudaDeviceSynchronize</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> threadsPerBlock <span style="color:#f92672">=</span> <span style="color:#ae81ff">256</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> blocksPerGrid <span style="color:#f92672">=</span> (<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>N <span style="color:#f92672">+</span> threadsPerBlock <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> threadsPerBlock;
</span></span><span style="display:flex;"><span>        copykernel<span style="color:#f92672">&lt;&lt;&lt;</span>blocksPerGrid, threadsPerBlock<span style="color:#f92672">&gt;&gt;&gt;</span>(signal, spectrum, N);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cudaDeviceSynchronize</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        blocksPerGrid <span style="color:#f92672">=</span> (N <span style="color:#f92672">+</span> threadsPerBlock <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> threadsPerBlock;
</span></span><span style="display:flex;"><span>        bitReverseKernel<span style="color:#f92672">&lt;&lt;&lt;</span>blocksPerGrid, threadsPerBlock<span style="color:#f92672">&gt;&gt;&gt;</span>(spectrum, N, lgn);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cudaDeviceSynchronize</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> s <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; s <span style="color:#f92672">&lt;</span> lgn; s<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            fft_kernel<span style="color:#f92672">&lt;&lt;&lt;</span>blocksPerGrid, threadsPerBlock<span style="color:#f92672">&gt;&gt;&gt;</span>(spectrum, N, s);
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">cudaDeviceSynchronize</span>();    
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>fft_kernel</code> ì˜ ê²½ìš° ê° ìŠ¤ë ˆë“œê°€ í•˜ë‚˜ì˜ butterfly ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤. <code>bitReverseKernel</code>ì€ ì…ë ¥ ë°ì´í„°ë¥¼ ë¹„íŠ¸ ë°˜ì „ ìˆœì„œë¡œ ì¬ë°°ì—´í•œë‹¤. <code>solve</code> í•¨ìˆ˜ëŠ” ì…ë ¥ ì‹ í˜¸ê°€ 2ì˜ ê±°ë“­ì œê³± í¬ê¸°ê°€ ì•„ë‹Œ ê²½ìš° DFTë¥¼ ì‚¬ìš©í•˜ê³ , ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš° FFTë¥¼ ìˆ˜í–‰í•œë‹¤.</p>
<h2 id="reverse-bit-order">reverse bit order</h2>
<p>ë¹„íŠ¸ë°˜ì „ì€ cooley-tukey ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ì—ì„œ ì„±ëŠ¥ë©´ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ í•œë‹¤. divide - conquer ê³¼ì •ì„ ìƒê°í•´ë³´ì.</p>
<p><code>[x0, x1, x2, x3, x4, x5, x6, x7]</code> ì´ë¼ëŠ” ì…ë ¥ì´ ìˆë‹¤ê³ í•˜ì.  ì´ ì…ë ¥ì„ ì§ìˆ˜ì™€ í™€ìˆ˜ë¡œ ë‚˜ëˆ„ë©´</p>
<ul>
<li>ì§ìˆ˜: <code>[x0, x2, x4, x6]</code></li>
<li>í™€ìˆ˜: <code>[x1, x3, x5, x7]</code>
ì´ ëœë‹¤. í•œë²ˆë” ì¬ê·€ì ìœ¼ë¡œ ë°˜ë³µí•˜ë©´</li>
<li>ì§ìˆ˜ì˜ ì§ìˆ˜: <code>[x0, x4]</code></li>
<li>ì§ìˆ˜ì˜ í™€ìˆ˜: <code>[x2, x6]</code></li>
<li>í™€ìˆ˜ì˜ ì§ìˆ˜: <code>[x1, x5]</code></li>
<li>í™€ìˆ˜ì˜ í™€ìˆ˜: <code>[x3, x7]</code>
ì´ ëœë‹¤. ì´ë¥¼ ë‹¤ì‹œ í•©ì¹˜ë©´ <code>[x0, x4, x2, x6, x1, x5, x3, x7]</code> ì´ ìˆœì„œê°€ ë°”ë¡œ ë¹„íŠ¸ ë°˜ì „ ìˆœì„œì´ë‹¤. ì¸ë±ìŠ¤ë¥¼ 3ë¹„íŠ¸ ì´ì§„ìˆ˜ë¡œ í‘œí˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤ <code>[000, 100, 010, 110, 001, 101, 011, 111]</code> ì´ê³  ì´ë¥¼ ë’¤ì§‘ìœ¼ë©´ <code>[000, 001, 010, 011, 100, 101, 110, 111]</code> ì´ ëœë‹¤. ì¦‰ ë¹„íŠ¸ ë°˜ì „ ìˆœì„œë¡œ ë°ì´í„°ë¥¼ ì¬ë°°ì—´í•˜ë©´ divide - conquer ê³¼ì •ì—ì„œì˜ ë©”ëª¨ë¦¬ ì ‘ê·¼ íŒ¨í„´ì´ ê°œì„ ë˜ì–´ ìºì‹œ íš¨ìœ¨ì„±ì´ ë†’ì•„ì§€ê³ , ë³‘ë ¬ ì²˜ë¦¬ ì‹œ ìŠ¤ë ˆë“œ ê°„ì˜ ë™ê¸°í™”ê°€ ìš©ì´í•´ì§„ë‹¤.</li>
</ul>
<h2 id="imporvements">Imporvements</h2>
<h3 id="shared-memory-ì‚¬ìš©">shared memory ì‚¬ìš©</h3>
<h3 id="algorithm-per-signal-length">Algorithm per signal Length</h3>
<p>ì§€ê¸ˆê¹Œì§€ ì‚´í´ë³¸ FFT ì•Œê³ ë¦¬ì¦˜ì€ ì…ë ¥ ì‹ í˜¸ì˜ ê¸¸ì´ê°€ 2ì˜ ê±°ë“­ì œê³±ì¼ ë•Œ ê°€ì¥ íš¨ìœ¨ì ì´ë‹¤. ê·¸ëŸ¬ë‚˜ ì‹¤ì œ ì‹ í˜¸ëŠ” í•­ìƒ ê·¸ëŸ°ê²ƒì´ ì•„ë‹ˆë‹¤. ì´ëŸ´ë•ŒëŠ” ì—¬ëŸ¬ ì „ëµì„ í•„ìš”ë¡œ í•œë‹¤.</p>
<ol>
<li>
<p><strong>Zero Padding</strong>: ì…ë ¥ ì‹ í˜¸ì˜ ê¸¸ì´ë¥¼ ê°€ì¥ ê°€ê¹Œìš´ 2ì˜ ê±°ë“­ì œê³±ìœ¼ë¡œ ëŠ˜ë¦¬ê¸° ìœ„í•´ 0ìœ¼ë¡œ ì±„ìš°ëŠ” ë°©ë²•ì´ë‹¤. ì´ ë°©ë²•ì€ êµ¬í˜„ì´ ê°„ë‹¨í•˜ê³  FFT ì•Œê³ ë¦¬ì¦˜ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì¶”ê°€ëœ 0ì´ ê²°ê³¼ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆë‹¤.</p>
</li>
<li>
<p><strong>Mixed-Radix FFT</strong>: ì…ë ¥ ì‹ í˜¸ì˜ ê¸¸ì´ê°€ 2ì˜ ê±°ë“­ì œê³±ì´ ì•„ë‹ ë•Œë„ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê¸¸ì´ê°€ 12ì¸ ì‹ í˜¸ëŠ” 3ê³¼ 4ì˜ ê³±ì´ë¯€ë¡œ, 3-ì ê³¼ 4-ì  FFTë¥¼ ê²°í•©í•˜ì—¬ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ì´ ë°©ë²•ì€ ë‹¤ì–‘í•œ ê¸¸ì´ì˜ ì‹ í˜¸ì— ëŒ€í•´ ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆë‹¤.</p>
</li>
<li>
<p><strong>Bluestein&rsquo;s Algorithm</strong>: ì„ì˜ì˜ ê¸¸ì´ì˜ ì‹ í˜¸ì— ëŒ€í•´ FFTë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ì´ ë°©ë²•ì€ ì…ë ¥ ì‹ í˜¸ë¥¼ íŠ¹ì •í•œ ë°©ì‹ìœ¼ë¡œ ë³€í™˜í•˜ì—¬, ê¸¸ì´ê°€ 2ì˜ ê±°ë“­ì œê³±ì¸ ì‹ í˜¸ë¡œ ë°”ê¾¸ê³ , ê·¸ í›„ì— FFTë¥¼ ì ìš©í•œë‹¤. ì´ ë°©ë²•ì€ ëª¨ë“  ê¸¸ì´ì˜ ì‹ í˜¸ì— ëŒ€í•´ ì ìš© ê°€ëŠ¥í•˜ì§€ë§Œ, êµ¬í˜„ì´ ë³µì¡í•˜ë‹¤.</p>
</li>
<li>
<p><strong>Rader&rsquo;s Algorithm</strong>: ì†Œìˆ˜ ê¸¸ì´ì˜ ì‹ í˜¸ì— ëŒ€í•´ FFTë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. ì´ ë°©ë²•ì€ ì…ë ¥ ì‹ í˜¸ë¥¼ ìˆœí™˜ ì»¨ë³¼ë£¨ì…˜ìœ¼ë¡œ ë³€í™˜í•˜ì—¬, ê¸¸ì´ê°€ 2ì˜ ê±°ë“­ì œê³±ì¸ ì‹ í˜¸ë¡œ ë°”ê¾¸ê³ , ê·¸ í›„ì— FFTë¥¼ ì ìš©í•œë‹¤. ì´ ë°©ë²• ì—­ì‹œ êµ¬í˜„ì´ ë³µì¡í•˜ë‹¤.</p>
</li>
</ol>
<h1 id="reference">Reference</h1>
<ul>
<li><a href="https://mitpress.mit.edu/9780262033848/the-introduction-to-algorithms-third-edition/">The Introduction to Algorithms, Third Edition</a></li>
<li><a href="https://en.wikipedia.org/wiki/Discrete_Fourier_transform">Discrete Fourier Transform</a></li>
<li><a href="https://en.wikipedia.org/wiki/Cooley%E2%80%93Tukey_FFT_algorithm">Cooleyâ€“Tukey FFT algorithm</a></li>
<li><a href="https://en.wikipedia.org/wiki/Fast_Fourier_transform">Fast Fourier Transform (FFT)</a></li>
<li><a href="https://en.wikipedia.org/wiki/Polynomial_multiplication">Polynomial multiplication</a></li>
</ul>

</article>


    <script src="https://utteranc.es/client.js"
        repo="elwhyjay/blog-comment"
        issue-term="title"
        label="âœ¨ğŸ’¬âœ¨"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>


            </div>
        </main>
        <script>
            
            function getEffectiveTheme(theme) {
              if (theme === 'auto') {
                return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
              }
              return theme;
            }

            function updateIcons(effectiveTheme) {
              const lightIcon = document.querySelector('.light-icon');
              const darkIcon = document.querySelector('.dark-icon');
              lightIcon.style.display = effectiveTheme === 'dark' ? 'none' : 'inline';
              darkIcon.style.display = effectiveTheme === 'dark' ? 'inline' : 'none';
            }

            function toggleTheme() {
              const body = document.querySelector('body');
              const currentTheme = body.getAttribute('a');
              const effective = getEffectiveTheme(currentTheme);
              const newTheme = effective === 'dark' ? 'light' : 'dark';

              body.setAttribute('a', newTheme);
              localStorage.setItem('theme', newTheme);
              updateIcons(newTheme);
            }

            
            document.addEventListener('DOMContentLoaded', () => {
              const savedTheme = localStorage.getItem('theme');
              if (savedTheme) {
                document.querySelector('body').setAttribute('a', savedTheme);
                updateIcons(savedTheme);
              } else {
                
                updateIcons(getEffectiveTheme('auto'));
              }
            });
        </script>
    </body>
</html>
